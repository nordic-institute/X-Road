{{- range $service, $config := .Values.services }}

{{- if or (ne $service "op-monitor") $config.enabled }} # Skip when service is op-monitor and it's not enabled
---
{{- include "xroad.serviceaccount" (dict "root" $ "service" $service "config" $config) }}
---
{{- include "xroad.configmap.env" (dict "root" $ "service" $service "config" $config) }}
---
{{- include "xroad.service" (dict "root" $ "service" $service "config" $config) }}
---
{{- include "xroad.deployment" (dict "root" $ "service" $service "config" $config) }}
{{- end }}

{{- end }}
