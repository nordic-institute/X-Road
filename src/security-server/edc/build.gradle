plugins {
    id("java")
    id("application")
    id("com.github.johnrengelman.shadow")
}

dependencies {
    implementation("org.eclipse.edc:control-plane-api-client:$edcVersion")
    implementation("org.eclipse.edc:control-plane-api:$edcVersion")
    implementation("org.eclipse.edc:control-plane-core:$edcVersion")
    implementation("org.eclipse.edc:dsp:$edcVersion")
    implementation("org.eclipse.edc:configuration-filesystem:$edcVersion")
    implementation("org.eclipse.edc:vault-filesystem:$edcVersion")
    implementation("org.eclipse.edc:iam-mock:$edcVersion")
    implementation("org.eclipse.edc:management-api:$edcVersion")
    implementation("org.eclipse.edc:transfer-data-plane:$edcVersion")
    implementation("org.eclipse.edc:transfer-pull-http-receiver:$edcVersion")

    implementation("org.eclipse.edc:data-plane-selector-api:$edcVersion")
    implementation("org.eclipse.edc:data-plane-selector-core:$edcVersion")
//    implementation("org.eclipse.edc:data-plane-selector-client:$edcVersion")

    implementation("org.eclipse.edc:data-plane-control-api:$edcVersion")
    implementation("org.eclipse.edc:data-plane-public-api:$edcVersion")
    implementation("org.eclipse.edc:data-plane-core:$edcVersion")
    implementation("org.eclipse.edc:data-plane-http:$edcVersion")

    // sql store
    //TODO xroad8-unittest
//    runtimeOnly("org.postgresql:postgresql:$postgresqlVersion")
//    runtimeOnly("org.eclipse.edc:sql-pool-apache-commons:$edcVersion")
//    runtimeOnly("org.eclipse.edc:transaction-local:$edcVersion")
//    implementation("org.eclipse.edc:asset-index-sql:$edcVersion")
//    implementation("org.eclipse.edc:data-plane-instance-store-sql:$edcVersion")
//    implementation("org.eclipse.edc:data-plane-store-sql:$edcVersion")
//    implementation("org.eclipse.edc:contract-definition-store-sql:$edcVersion")
//    implementation("org.eclipse.edc:contract-negotiation-store-sql:$edcVersion")
//    implementation("org.eclipse.edc:policy-definition-store-sql:$edcVersion")
//    implementation("org.eclipse.edc:transfer-process-store-sql:$edcVersion")
}

application {
    mainClass.set("org.eclipse.edc.boot.system.runtime.BaseRuntime")
}


var distTar = tasks.named("distTar")
var distZip = tasks.named("distZip")

shadowJar {
    mergeServiceFiles()
    archiveFileName.set("connector.jar")
    dependsOn(distTar, distZip)
}
