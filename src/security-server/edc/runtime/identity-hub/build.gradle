plugins {
    id("java")
    id("application")
    alias(libs.plugins.shadow)
}

configurations {
    configureEach {
        exclude group: 'org.eclipse.edc', module: 'jetty-core'
        exclude group: 'com.apicatalog', module: 'titanium-json-ld-jre8' //transient dep that creates errors
    }
}

dependencies {
    implementation libs.edc.configuration.filesystem
    implementation libs.edc.vault.hashicorp

    implementation libs.edc.identity.trust.spi
    implementation libs.bundles.edc.connector
    implementation libs.bundles.edc.did

    // embedded Identity Hub
    implementation libs.bundles.edc.identity.hub.management.api
    implementation libs.edc.identity.hub.api
    implementation libs.edc.identity.hub.core
    implementation libs.edc.identity.hub.participants
    implementation libs.edc.identity.hub.keypairs
    implementation libs.edc.keypair.spi
    implementation libs.edc.identity.hub.store.spi

    implementation libs.edc.identity.hub.did

    implementation libs.edc.ldp.verifiable.credentials
    implementation libs.edc.verifiablecredential.spi
    implementation libs.edc.verifiable.presentation.lib
    implementation libs.edc.jsonLd.spi
//TODO excluded until https://github.com/eclipse-edc/Connector/issues/4232 is fixed    implementation libs.edc.jsonLd.lib

    implementation libs.bundles.edc.monitoring

    implementation(project(":security-server:edc:extensions:xroad-jsonld"))
    implementation(project(":security-server:edc:extensions:xroad-ldp-verifiable-credentials"))
    implementation(project(":security-server:edc:extensions:xroad-webserver"))

    testImplementation libs.edc.jws2020.lib
    testImplementation libs.edc.junit
    testImplementation libs.mockito.jupiter
}

application {
    mainClass.set("org.eclipse.edc.boot.system.runtime.BaseRuntime")
}

shadowJar {
    mergeServiceFiles()
    archiveFileName.set("edc-identity-hub.jar")
}
