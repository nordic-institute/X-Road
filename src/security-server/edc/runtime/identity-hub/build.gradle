plugins {
    id("java")
    id("application")
    alias(libs.plugins.shadow)
}

configurations {
    configureEach {
        exclude group: 'org.eclipse.edc', module: 'jetty-core'
        exclude group: 'com.apicatalog', module: 'titanium-json-ld-jre8' //transient dep that creates errors
    }
}

dependencies {
    runtimeOnly(libs.bundles.identityhub)
    runtimeOnly(libs.edc.config.filesystem)
    runtimeOnly(libs.edc.api.observability)
    runtimeOnly(libs.edc.vault.hashicorp)
    //runtimeOnly(libs.bundles.sql.ih)

    runtimeOnly(libs.bundles.identity.api)

    implementation(libs.bundles.did)
    implementation(libs.bundles.connector)
    implementation(libs.edc.ih.spi.store)
    implementation(libs.edc.identity.vc.ldp)
    implementation(libs.edc.ih.lib.credentialquery)
    implementation(libs.edc.lib.vp)
    implementation (libs.edc.lib.jsonld)

    implementation(project(":security-server:edc:extensions:xroad-conf"))
    implementation(project(":security-server:edc:extensions:xroad-jsonld"))
    implementation(project(":security-server:edc:extensions:xroad-ldp-verifiable-credentials"))
    implementation(project(":security-server:edc:extensions:xroad-webserver"))

    testImplementation libs.edc.junit
    testImplementation libs.mockito.jupiter
}

application {
    mainClass.set("org.eclipse.edc.boot.system.runtime.BaseRuntime")
}

shadowJar {
    mergeServiceFiles()
    archiveFileName.set("edc-identity-hub.jar")
}

checkstyle {
    checkstyleMain.enabled = false
    checkstyleTest.enabled = false
}
