quarkus:
  application:
    name: proxy
  config:
    locations:
      - /etc/xroad/conf.d/local.yaml
      - /etc/xroad/db.properties
      - xroad-common.yaml
      - xroad-logging.yaml

script:
  generate-certificate:
    path: /usr/share/xroad/scripts/generate_certificate.sh
    args: -n internal -f -S -p 2>&1

"%containerized":
  xroad:
    proxy:
      rpc:
        listen-address: 0.0.0.0
  script:
    generate-certificate:
      path: /opt/app/scripts/generate_certificate.sh
      args: -c /opt/app/scripts -n internal -f -S -p 2>&1

"%native":
  quarkus:
    log:
      console:
        enable: false
      file:
        enable: true
        path: /var/log/xroad/proxy.log
      category:
        "org.niis.xroad.proxy.core.clientproxy.RequestLog":
          level: INFO
          handlers: [ clientproxy-access-log ]
          use-parent-handlers: false
        "org.niis.xroad.proxy.core.serverproxy.RequestLog":
          level: INFO
          handlers: [ serverproxy-access-log ]
          use-parent-handlers: false
      handler:
        file:
          "clientproxy-access-log":
            enable: true
            path: /var/log/xroad/clientproxy_access.log
            format: "%s%e%n"
            encoding: utf-8
            rotation:
              max-file-size: 100m
              file-suffix: .yyyy-MM-dd.zip
              rotate-on-boot: false
          "serverproxy-access-log":
            enable: true
            path: /var/log/xroad/serverproxy_access.log
            format: "%s%e%n"
            encoding: utf-8
            rotation:
              max-file-size: 100m
              file-suffix: .yyyy-MM-dd.zip
              rotate-on-boot: false
